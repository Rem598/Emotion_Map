{% extends 'base.html' %}

{% block content %}
<div>
    <h1 class="page-title">Your Dashboard</h1>
    
    
    <p>Total Logs: {{ total_logs }}</p>
    <p>Recent Moods Count: {{ recent_moods|length }}</p>

    <!-- Stats Cards -->
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-value stat-value-purple">{{ total_logs }}</div>
            <div class="stat-label">Total Mood Logs</div>
        </div>
        <div class="stat-card">
            <div class="stat-value stat-value-blue">{{ total_interventions }}</div>
            <div class="stat-label">Active Interventions</div>
        </div>
        <div class="stat-card">
            <div class="stat-value stat-value-green">{{ total_feedback }}</div>
            <div class="stat-label">Community Feedback</div>
        </div>
    </div>

    <!-- Mood Trend Chart -->
    <div class="card card-large">
        <h2 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;">7-Day Mood Trend</h2>
        <p style="color: blue;">Chart data labels: {{ trend_labels }}</p>
        <p style="color: blue;">Chart data values: {{ trend_data }}</p>
        <canvas id="moodTrendChart" height="80"></canvas>
    
    </div>

    <!-- Recent Moods -->
    <div class="card" style="margin-top: 2rem;">
        <h2 style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;">Recent Mood Logs</h2>
        {% if recent_moods %}
            {% for mood in recent_moods %}
            <div class="mood-item">
                <div class="mood-header">
                    <div>
                        <span class="mood-emotion">{{ mood.get_emotion_display }}</span>
                        <span class="mood-intensity">Intensity: {{ mood.intensity }}/10</span>
                    </div>
                    <span class="mood-timestamp">{{ mood.timestamp|date:"M d, H:i" }}</span>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <p style="color: #9ca3af; font-style: italic;">No mood logs yet.</p>
        {% endif %}
    </div>
</div>

<!-- Hidden data for JavaScript -->
<script id="chart-data" type="application/json">
{
    "labels": {{ trend_labels|safe }},
    "data": {{ trend_data|safe }}
}
</script>

<script>
console.log('Dashboard template loaded!');
console.log('Chart data element:', document.getElementById('chart-data'));
console.log('Canvas element:', document.getElementById('moodTrendChart'));
</script>
{% endblock %}

{% block extra_js %}
<script src="/static/js/dashboard.js"></script>
<script>
console.log('Dashboard JS should have loaded');
</script>
{% endblock %}